<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#FB4747">
    <title data-i18n="pageTitle">AndroGov | Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tailwind & Charts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brandRed: '#FB4747',
                        brandBlue: '#4267B2',
                        brandDark: '#1E293B',
                        brandGray: '#F8FAFC'
                    },
                    fontFamily: {
                        sans: ['Tajawal', 'Inter', 'sans-serif'],
                        en: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        @media print { .no-print { display: none !important; } }
        body { transition: opacity 0.2s ease-in-out; }
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        .dark .custom-scroll::-webkit-scrollbar-thumb { background-color: #475569; }
        
        /* Chatbot Animations */
        .chat-window-anim { transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1); transform-origin: bottom left; }
        .chat-bubble { max-width: 85%; padding: 10px 14px; border-radius: 12px; font-size: 0.9rem; line-height: 1.5; word-wrap: break-word; }
        .chat-bubble.bot { background-color: #f1f5f9; color: #334155; border-bottom-right-radius: 2px; }
        .dark .chat-bubble.bot { background-color: #334155; color: #f8fafc; }
        .chat-bubble.user { background-color: #4267B2; color: white; border-bottom-left-radius: 2px; margin-right: auto; }
    </style>
</head>
<body class="bg-brandGray dark:bg-slate-900 text-slate-800 dark:text-slate-100 font-sans transition-colors duration-300">

    <!-- 1. Layout Containers (Will be populated by Embedded Layout Engine) -->
    <div id="sidebar-container" class="no-print"></div>
    
    <div class="main-content-wrapper md:mr-72 transition-all duration-300 flex flex-col min-h-screen">
        <div id="header-container" class="no-print"></div>

        <!-- 2. Main Content (Dashboard Specific) -->
        <main class="p-6 space-y-6">
            
            <!-- 2.1 Urgent Alerts -->
            <div class="bg-white dark:bg-slate-800 rounded-2xl p-1 border-r-4 border-orange-500 shadow-sm flex flex-col md:flex-row items-center justify-between gap-4 overflow-hidden">
                <div class="p-4 flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-orange-100 dark:bg-orange-500/20 text-orange-600 dark:text-orange-400 flex items-center justify-center text-xl shrink-0">
                        <i class="fa-solid fa-triangle-exclamation"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg dark:text-white" data-i18n="alertTitle">Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø·Ù„ÙˆØ¨: Ø§Ø¹ØªÙ…Ø§Ø¯ "Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ"</h3>
                        <p class="text-sm text-slate-500 dark:text-slate-400">
                            <span data-i18n="alertDesc">Ù…Ø³ÙˆØ¯Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø³. Ø§Ù„Ø±Ø§ÙØ¹:</span> 
                            <span class="font-bold text-slate-700 dark:text-slate-300" data-i18n="uploaderName">Ø£ÙŠÙ…Ù† Ø§Ù„Ù…ØºØ±Ø¨ÙŠ</span>
                        </p>
                    </div>
                </div>
                <div class="p-4">
                    <button class="px-6 py-2 bg-brandRed text-white rounded-lg text-sm font-bold shadow-lg shadow-red-500/20 hover:bg-red-700 transition flex items-center gap-2">
                        <i class="fa-solid fa-file-signature"></i> <span data-i18n="reviewBtn">Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø¹ØªÙ…Ø§Ø¯</span>
                    </button>
                </div>
            </div>

            <!-- 2.2 KPIs Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Capital -->
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-md transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-xs text-slate-500 dark:text-slate-400 font-bold uppercase" data-i18n="kpiCapital">Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø§Ù„Ù…ØµØ¯Ø±</p>
                            <h3 class="text-2xl font-bold mt-1 font-en">6,000,000 <span class="text-xs font-sans text-slate-400" data-i18n="currency">Ø±.Ø³</span></h3>
                        </div>
                        <div class="w-10 h-10 rounded-xl bg-blue-50 dark:bg-blue-900/30 text-blue-600 flex items-center justify-center">
                            <i class="fa-solid fa-coins"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center gap-2 text-xs text-green-500 font-bold bg-green-50 dark:bg-green-900/20 w-fit px-2 py-1 rounded">
                        <i class="fa-solid fa-check"></i> <span data-i18n="fullyPaid">Ù…Ø¯ÙÙˆØ¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</span>
                    </div>
                </div>

                <!-- Shareholders Count -->
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-md transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-xs text-slate-500 dark:text-slate-400 font-bold uppercase" data-i18n="kpiShareholders">Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†</p>
                            <h3 class="text-2xl font-bold mt-1 font-en" id="shareholder-count">-- <span class="text-xs font-sans text-slate-400" data-i18n="member">Ø¹Ø¶Ùˆ</span></h3>
                        </div>
                        <div class="w-10 h-10 rounded-xl bg-purple-50 dark:bg-purple-900/30 text-purple-600 flex items-center justify-center">
                            <i class="fa-solid fa-users"></i>
                        </div>
                    </div>
                    <div class="mt-4 text-xs text-slate-400 truncate w-full" data-i18n="shareholdersList">
                        ÙˆØ±Ø«Ø© Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠØŒ Ø´Ø±ÙƒØ© Ø¨ÙŠØ¬ÙŠ...
                    </div>
                </div>

                <!-- Employees Count -->
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-md transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-xs text-slate-500 dark:text-slate-400 font-bold uppercase" data-i18n="kpiStaff">Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</p>
                            <h3 class="text-2xl font-bold mt-1 font-en text-brandRed" id="staff-count">--</h3>
                        </div>
                        <div class="w-10 h-10 rounded-xl bg-red-50 dark:bg-red-900/30 text-brandRed flex items-center justify-center">
                            <i class="fa-solid fa-user-tie"></i>
                        </div>
                    </div>
                    <div class="mt-4 flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400">
                        <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                        <span data-i18n="systemOnline">Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨ÙƒÙØ§Ø¡Ø©</span>
                    </div>
                </div>

                <!-- Compliance -->
                <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-md transition">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-xs text-slate-500 dark:text-slate-400 font-bold uppercase" data-i18n="kpiComp">Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„</p>
                            <h3 class="text-2xl font-bold mt-1 font-en text-green-600">92%</h3>
                        </div>
                        <div class="w-10 h-10 rounded-xl bg-green-50 dark:bg-green-900/30 text-green-600 flex items-center justify-center">
                            <i class="fa-solid fa-shield-halved"></i>
                        </div>
                    </div>
                    <div class="w-full bg-slate-100 dark:bg-slate-700 h-1.5 rounded-full mt-5 overflow-hidden">
                        <div class="bg-green-500 h-full w-[92%]"></div>
                    </div>
                </div>
            </div>

            <!-- 2.3 Charts & Lists -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Ownership Structure -->
                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-slate-700 dark:text-white flex items-center gap-2">
                            <i class="fa-solid fa-chart-pie text-brandBlue"></i> <span data-i18n="chartTitle">Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</span>
                        </h3>
                    </div>
                    <div class="h-48 relative flex justify-center">
                        <canvas id="ownershipChart"></canvas>
                    </div>
                    <div class="mt-6 space-y-3" id="chartLegend"></div>
                </div>

                <!-- Tasks & Operations -->
                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 flex flex-col lg:col-span-2">
                    <h3 class="font-bold text-slate-700 dark:text-white mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-list-check text-green-500"></i> <span data-i18n="opsTitle">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</span>
                    </h3>
                    
                    <div class="flex-1 space-y-3 overflow-y-auto max-h-64 pr-2 custom-scroll">
                        <div class="flex gap-3 items-start p-3 rounded-xl bg-slate-50 dark:bg-slate-700/30 border border-slate-100 dark:border-slate-700/50">
                            <div class="mt-1"><input type="checkbox" class="accent-brandRed w-4 h-4"></div>
                            <div>
                                <p class="text-xs font-bold text-slate-800 dark:text-white" data-i18n="task1">Ø§Ø¹ØªÙ…Ø§Ø¯ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</p>
                                <p class="text-[10px] text-slate-400 mt-1"><span data-i18n="dueDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</span>: 01/02/2026</p>
                                <span class="inline-block mt-1 bg-yellow-100 text-yellow-700 text-[9px] px-1.5 py-0.5 rounded" data-i18n="gov">Gov</span>
                            </div>
                        </div>
                        <div class="flex gap-3 items-start p-3 rounded-xl bg-slate-50 dark:bg-slate-700/30 border border-slate-100 dark:border-slate-700/50">
                            <div class="mt-1"><input type="checkbox" class="accent-brandRed w-4 h-4"></div>
                            <div>
                                <p class="text-xs font-bold text-slate-800 dark:text-white" data-i18n="taskPayroll">Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±ÙˆØ§ØªØ¨ (HR)</p>
                                <p class="text-[10px] text-slate-400 mt-1"><span data-i18n="fromLabel">Ù…Ù†</span>: <span data-i18n="senderName">Ù…Ù†ØµÙˆØ± Ø§Ù„ÙŠØ§Ù…ÙŠ</span></p>
                                <span class="inline-block mt-1 bg-blue-100 text-blue-700 text-[9px] px-1.5 py-0.5 rounded" data-i18n="ops">Ops</span>
                            </div>
                        </div>
                        <div class="flex gap-3 items-start p-3 rounded-xl bg-slate-50 dark:bg-slate-700/30 border border-slate-100 dark:border-slate-700/50">
                            <div class="mt-1"><input type="checkbox" class="accent-brandRed w-4 h-4"></div>
                            <div>
                                <p class="text-xs font-bold text-slate-800 dark:text-white" data-i18n="task3">ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</p>
                                <p class="text-[10px] text-slate-400 mt-1" data-i18n="ministry">ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¬Ø§Ø±Ø©</p>
                                <span class="inline-block mt-1 bg-purple-100 text-purple-700 text-[9px] px-1.5 py-0.5 rounded" data-i18n="legal">Legal</span>
                            </div>
                        </div>
                    </div>
                    <a href="#" class="mt-4 text-center text-xs text-brandBlue hover:underline" data-i18n="viewAll">Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (12)</a>
                </div>
            </div>

            <!-- 2.4 Live Audit Log -->
            <div class="bg-slate-900 rounded-2xl p-5 shadow-lg text-slate-300 font-mono text-xs border border-slate-800">
                <div class="flex justify-between items-center mb-3 border-b border-slate-700 pb-3">
                    <span class="flex items-center gap-2 font-bold text-white"><i class="fa-solid fa-terminal text-brandRed"></i> <span data-i18n="auditTitle">Ø³Ø¬Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</span></span>
                    <span class="flex items-center gap-2 text-green-400"><span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span> Live</span>
                </div>
                <div class="space-y-2 h-32 overflow-y-auto custom-scroll" id="audit-log-container">
                    <!-- Logs via JS -->
                </div>
            </div>

        </main>
    </div>

    <!-- AI Chatbot Widget -->
    <div id="andro-bot-container" class="fixed bottom-6 left-6 z-50 flex flex-col items-start gap-4" dir="rtl">
        <div id="chat-window" class="hidden bg-white dark:bg-slate-800 w-80 md:w-96 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 overflow-hidden flex flex-col chat-window-anim" style="height: 500px; max-height: 70vh;">
            <div class="bg-brandBlue p-4 flex justify-between items-center text-white">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center"><i class="fa-solid fa-robot"></i></div>
                    <div><h4 class="font-bold text-sm">AndroBot</h4><p class="text-[10px] text-white/80">Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø°ÙƒÙŠ</p></div>
                </div>
                <button id="close-chat-btn" class="text-white/80 hover:text-white transition"><i class="fa-solid fa-times"></i></button>
            </div>
            <div id="chat-body" class="flex-1 p-4 bg-slate-50 dark:bg-slate-900/50 overflow-y-auto custom-scroll space-y-3 flex flex-col">
                <div class="chat-bubble bot">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ğŸ‘‹<br>Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ. Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø£Ùˆ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©.</div>
            </div>
            <div class="p-3 bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 flex gap-2">
                <input type="text" id="chat-input" placeholder="Ø§ÙƒØªØ¨..." class="flex-1 bg-slate-100 dark:bg-slate-900 border-none rounded-lg text-sm px-4 py-2 focus:ring-2 focus:ring-brandBlue outline-none dark:text-white">
                <button id="send-btn" class="w-10 h-10 rounded-lg bg-brandBlue text-white hover:bg-blue-700 transition flex items-center justify-center"><i class="fa-solid fa-paper-plane"></i></button>
            </div>
        </div>
        <button id="chat-fab" class="w-14 h-14 bg-brandBlue hover:bg-blue-700 text-white rounded-full shadow-lg shadow-blue-600/30 flex items-center justify-center text-2xl transition-all transform hover:scale-110 active:scale-95 animate-bounce-slow">
            <i class="fa-solid fa-comment-dots"></i>
            <span class="absolute top-0 right-0 w-4 h-4 bg-brandRed rounded-full border-2 border-white dark:border-slate-900"></span>
        </button>
    </div>

    <!-- 3. Embedded Scripts -->
    <script>
        // ==========================================
        // A. DATA REPOSITORY (EMBEDDED FULL)
        // ==========================================
        const SYSTEM_DATA = {
            users: [
                { id: "USR_000", name: { ar: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­ÙˆØ§Ø³", en: "Abdullah Al-Hawas" }, title: { ar: "Ø±Ø¦ÙŠØ³ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©", en: "Chairman of the Board" }, dept: "DEP_EXEC", role_ref: "chairman", email: "amh400@gmail.com" },
                { id: "USR_001", name: { ar: "Ù‡Ø´Ø§Ù… Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ", en: "Hesham Al-Sohaibani" }, title: { ar: "Ø§Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ ÙˆÙ†Ø§Ø¦Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³", en: "CEO & Board Vice Chairman" }, dept: "DEP_EXEC", role_ref: "ceo", email: "hesham@androomeda.com" },
                { id: "USR_002", name: { ar: "Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¨Ø®ÙŠØªÙŠ", en: "Mohammed Al-Bukheiti" }, title: { ar: "Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠ", en: "Chief Financial Officer (CFO)" }, dept: "DEP_FIN", role_ref: "cfo", email: "mtahir@androomeda.com" },
                { id: "USR_003", name: { ar: "Ù‡Ø§Ø¯ÙŠ Ø£Ø­Ù…Ø¯", en: "Hadi Ahmed" }, title: { ar: "Ù…Ù†Ø³Ù‚ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙˆØ§Ù„Ø¯Ø¹Ù…", en: "Purchasing Coordinator" }, dept: "DEP_PROC", role_ref: "employee", email: "hadi@androomeda.com" },
                { id: "USR_004", name: { ar: "Ø£ÙŠÙ…Ù† Ø§Ù„Ù…ØºØ±Ø¨ÙŠ", en: "Ayman Al-Maghrabi" }, title: { ar: "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø­ÙˆÙƒÙ…Ø© / Ø£Ù…ÙŠÙ† Ø§Ù„Ø³Ø±", en: "GRCO / Board Secretary" }, dept: "DEP_COMP", role_ref: "manager", email: "amaghrabi@androomeda.com" },
                { id: "USR_005", name: { ar: "Ù…Ù†ØµÙˆØ± Ø§Ù„ÙŠØ§Ù…ÙŠ", en: "Mansour Al-Yami" }, title: { ar: "Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ / Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³", en: "CAO / Board Member" }, dept: "DEP_HR", role_ref: "manager", email: "myami@androomeda.com" },
                { id: "USR_006", name: { ar: "Ø¯. ÙˆØ¹Ø¯ Ø­Ø³ÙŠÙ†", en: "Dr. Waad Hussein" }, title: { ar: "Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø·Ø¨ÙŠ", en: "Medical Supervisor" }, dept: "DEP_MED", role_ref: "manager", email: "whussain@androomeda.com" },
                { id: "USR_007", name: { ar: "Ù†ÙˆØ§Ù Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ", en: "Nawaf Al-Sahabi" }, title: { ar: "Ù…Ø¯ÙŠØ± Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡", en: "Customer Accounts Manager" }, dept: "DEP_CS", role_ref: "team_lead", email: "nalsahabi@androomeda.com" },
                { id: "USR_008", name: { ar: "Ø§Ù„Ø­Ø³ÙŠÙ† Ø§Ù„Ø­Ù…ÙŠØ¯ÙŠ", en: "Al-Hussain Al-Humaidi" }, title: { ar: "Ø£Ø®ØµØ§Ø¦ÙŠ Ø¯Ø¹Ù… ÙÙ†ÙŠ", en: "Technical Support Specialist" }, dept: "DEP_CS", role_ref: "employee", email: "alhussien@androomeda.com" },
                { id: "USR_009", name: { ar: "Ù…Ø´Ø§Ø¹Ù„ Ø§Ù„Ù‡Ø°ÙŠØ§Ù†", en: "Meshail Al-Hadyan" }, title: { ar: "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ", en: "NCSO" }, dept: "DEP_SEC", role_ref: "manager", email: "malhadyan@androomeda.com" },
                { id: "USR_010", name: { ar: "Ù…Ù‡Ø§ Ø§Ù„Ø­Ø²Ø§Ù†", en: "Maha Al-Hazzan" }, title: { ar: "Ø£Ø®ØµØ§Ø¦ÙŠ ØªØ³ÙˆÙŠÙ‚ Ø±Ù‚Ù…ÙŠ", en: "Digital Marketing Specialist" }, dept: "DEP_MKT", role_ref: "employee", email: "mhizan@androomeda.com" },
                { id: "USR_011", name: { ar: "Ø´Ø§ØºØ±", en: "Vacant" }, title: { ar: "Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", en: "Sales Manager" }, dept: "DEP_SALES", role_ref: "manager", email: "SalesManager@androomeda.com", status: "inactive" },
                { id: "USR_014", name: { ar: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¬Ø¨ÙŠØ±", en: "Abdullah Al-Jubeir" }, title: { ar: "Ø¯Ø¹Ù… Ø¥Ø¯Ø§Ø±ÙŠ", en: "Office Support" }, dept: "DEP_HR", role_ref: "employee", email: "Ajubeir@androomeda.com" },
                { id: "USR_015", name: { ar: "Ø±Ù†Ø¯ Ø§Ù„Ø­ÙˆØ±Ø§Ù†ÙŠ", en: "Rand Al-Hourani" }, title: { ar: "Ù‚Ø§Ø¦Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ØªÙ‚Ù†ÙŠ", en: "Technical Team Lead" }, dept: "DEP_TECH", role_ref: "team_lead", email: "Rhourani@androomeda.com" },
                { id: "USR_020", name: { ar: "Ù…Ø­Ù…Ø¯ Ø£Ø®ØªØ±", en: "Muhammad Akhtar" }, title: { ar: "Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ·ÙˆÙŠØ±", en: "Director of Development" }, dept: "DEP_TECH", role_ref: "manager", email: "Makhtar@androomeda.com" },
                { id: "USR_023", name: { ar: "ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±", en: "Software Developers Team" }, title: { ar: "ÙØ±ÙŠÙ‚ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª", en: "Software Developers Team" }, dept: "DEP_TECH", role_ref: "employee", email: "SDT@androomeda.com" },
                { id: "COMM_01", name: { ar: "Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹Ù†Ø²ÙŠ", en: "Mohammed Al-Enezi" }, title: { ar: "Ø±Ø¦ÙŠØ³ Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©", en: "Audit Committee Chairman" }, dept: "DEP_AUDIT", role_ref: "board_member", email: "mohammedmansour.socpa@gmail.com" },
                { id: "COMM_02", name: { ar: "Ø¹Ø§Ø¯Ù„ Ø³Ø§Ø³Ø§", en: "Adel Sasa" }, title: { ar: "Ø¹Ø¶Ùˆ Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©", en: "Audit Committee Member" }, dept: "DEP_AUDIT", role_ref: "viewer", email: "adel.sasa1@gmail.com" },
                { id: "BRD_003", name: { ar: "Ø£Ø­Ù…Ø¯ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ", en: "Ahmed Al-Suhaibani" }, title: { ar: "Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³ Ø¥Ø¯Ø§Ø±Ø© ÙˆÙ„Ø¬Ù†Ø©", en: "Board & Audit Member" }, dept: "DEP_EXEC", role_ref: "board_member", email: "a.s.alsuhaibani@microtec.com.sa" },
                { id: "AUD_INT", name: { ar: "Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ", en: "Internal Auditor" }, title: { ar: "Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ", en: "Internal Auditor" }, dept: "DEP_AUDIT", role_ref: "manager", email: "InternalAudit@androomeda.com" },
                { id: "AUD_EXT", name: { ar: "Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ", en: "External Auditor" }, title: { ar: "Ø§Ù„Ù…Ø¯Ù‚Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ (KPMG/EY)", en: "External Auditor (KPMG/EY)" }, dept: "DEP_AUDIT", role_ref: "viewer", email: "ExternalAudit@androomeda.com" }
            ],
            shareholders: [
                { id: "SH_001", name: { ar: "ÙˆØ±Ø«Ø© Ù…Ø­Ù…Ø¯ Ø¨Ù† ØµØ§Ù„Ø­ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ", en: "Heirs of Mohammed Al-Suhaibani" }, email: "alcaseer@gmail.com", percent: 35 },
                { id: "SH_002", name: { ar: "Ù‡Ø´Ø§Ù… Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ", en: "Hesham bin Muhammad Al-Sohibani" }, email: "Hesham@androomeda.com", percent: 10 },
                { id: "SH_003", name: { ar: "ÙˆØ§Ø¦Ù„ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ", en: "Wael bin Mohammed Al Suhaibani" }, email: "W961@live.com", percent: 5 },
                { id: "SH_004", name: { ar: "Ù‡ÙŠØ«Ù… Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ", en: "Haitham bin Mohammed Al Suhaibani" }, email: "hmsasis@gmail.com", percent: 5 },
                { id: "SH_005", name: { ar: "Ù…Ù†ØµÙˆØ± Ø¨Ù† Ø­Ø³Ù† Ø§Ù„ÙŠØ§Ù…ÙŠ", en: "Mansour bin Hassan Al-Yami" }, email: "myami@androomeda.com", percent: 5 },
                { id: "SH_006", name: { ar: "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¨Ù† Ø­Ù…Ø¯ Ø§Ù„Ø³ÙƒÙŠØªÙŠ", en: "Ibrahim bin Hamad Al Skeiti" }, email: "ihskaity@gmail.com", percent: 5 },
                { id: "SH_007", name: { ar: "ØµØ§Ù„Ø­ Ø¨Ù† Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„ÙˆÙ‡ÙŠØ¨ÙŠ", en: "Saleh bin Abdullah Al-Wahibi" }, email: "Saaw4466@yahoo.com", percent: 5 },
                { id: "SH_008", name: { ar: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ø¹Ù„ÙŠ Ø§Ù„ÙØ±ÙŠØ¬ÙŠ", en: "Abdullah bin Ali Al-Fariji" }, email: "a_furaiji@hotmail.com", percent: 5 },
                { id: "SH_009", name: { ar: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ø­ÙˆØ§Ø³", en: "Abdullah bin Mohammed Al-Hawas" }, email: "amh400@gmail.com", percent: 5 },
                { id: "SH_010", name: { ar: "Ø´Ø±ÙƒØ© Ø¨ÙŠØ¬ÙŠ Ø§Ù„Ù…Ø­Ø¯ÙˆØ¯Ø©", en: "BG LTD.Company" }, email: "saleh@bgtech.com", percent: 15 },
                { id: "SH_011", name: { ar: "Ø§Ø­Ù…Ø¯ Ø¨Ù† Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„Ø¬Ø§Ø³Ø±", en: "Ahmed bin Suleiman Al-Jasser" }, email: "ahmed.jasser@gmail.com", percent: 5 }
            ]
        };

        // ==========================================
        // B. LAYOUT ENGINE (EMBEDDED)
        // ==========================================
        (function() {
            // Globals
            let currentUser = JSON.parse(localStorage.getItem('currentUser')) || {
                id: "USR_004", name: {ar: "Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¸Ø§Ù…", en: "System User"}, role: "Guest"
            };
            const config = {
                lang: localStorage.getItem('lang') || 'ar',
                theme: localStorage.getItem('theme') || 'light'
            };

            const menuStructure = [
                { section: 'main', items: [{ key: 'dash', icon: 'fa-gauge-high', link: 'admin.html' }] },
                { section: 'comm', items: [{ key: 'chat', icon: 'fa-comments', link: 'admin_chat.html' }, { key: 'circulars', icon: 'fa-bullhorn', link: 'admin_circulars.html' }] },
                { section: 'gov', items: [{ key: 'ga', icon: 'fa-users-rectangle', link: 'ga.html' }, { key: 'board', icon: 'fa-building-columns', link: 'board.html' }, { key: 'committees', icon: 'fa-people-group', link: 'committees.html' }, { key: 'shareholders', icon: 'fa-id-card', link: 'shareholders.html' }] },
                { section: 'ops', items: [{ key: 'doa', icon: 'fa-sitemap', link: 'doa.html' }, { key: 'policies', icon: 'fa-book-open', link: 'policies.html' }, { key: 'compliance', icon: 'fa-scale-balanced', link: 'compliance.html' }] },
                { section: 'dept', items: [{ key: 'hr', icon: 'fa-user-tie', link: 'hr.html' }, { key: 'finance', icon: 'fa-money-bill-wave', link: 'finance.html' }, { key: 'procurement', icon: 'fa-boxes-packing', link: 'procurement.html' }, { key: 'it', icon: 'fa-shield-cat', link: 'it.html' }] },
                { section: 'admin', items: [{ key: 'users', icon: 'fa-users-gear', link: 'users.html' }, { key: 'audit', icon: 'fa-list-ul', link: 'audit.html' }, { key: 'settings', icon: 'fa-sliders', link: 'admin_settings.html' }] }
            ];

            const layoutTrans = {
                ar: {
                    sysName: "AndroGov", sysVer: "Enterprise v4.3", logout: "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬",
                    notifTitle: "Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª", markRead: "ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…Ù‚Ø±ÙˆØ¡", emptyNotif: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©",
                    sections: { main: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", comm: "Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ", gov: "Ø§Ù„Ø­ÙˆÙƒÙ…Ø©", ops: "Ø§Ù„ØªØ´ØºÙŠÙ„", dept: "Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª", admin: "Ø§Ù„Ù†Ø¸Ø§Ù…" },
                    menu: { dash: "Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©", chat: "Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©", circulars: "Ø§Ù„ØªØ¹Ø§Ù…ÙŠÙ…", ga: "Ø§Ù„Ø¬Ù…Ø¹ÙŠØ§Øª Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©", board: "Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©", committees: "Ø§Ù„Ù„Ø¬Ø§Ù†", shareholders: "Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†", doa: "Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (DOA)", policies: "Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª", compliance: "Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„", hr: "Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©", finance: "Ø§Ù„Ù…Ø§Ù„ÙŠØ©", procurement: "Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª", it: "Ø§Ù„ØªÙ‚Ù†ÙŠØ©", users: "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†", audit: "Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚", settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" }
                },
                en: {
                    sysName: "AndroGov", sysVer: "Enterprise v4.3", logout: "Logout",
                    notifTitle: "Notifications", markRead: "Mark Read", emptyNotif: "No notifications",
                    sections: { main: "Main", comm: "Communication", gov: "Governance", ops: "Operations", dept: "Departments", admin: "Admin" },
                    menu: { dash: "Dashboard", chat: "Chat", circulars: "Circulars", ga: "General Assembly", board: "Board", committees: "Committees", shareholders: "Shareholders", doa: "DOA Matrix", policies: "Policies", compliance: "Compliance", hr: "HR", finance: "Finance", procurement: "Procurement", it: "IT", users: "Users", audit: "Audit Log", settings: "Settings" }
                }
            };

            function initLayout() {
                const foundUser = SYSTEM_DATA.users.find(u => u.id === currentUser.id) || SYSTEM_DATA.users[4]; 
                if(foundUser) {
                    currentUser = {
                        ...currentUser,
                        name: foundUser.name,
                        title: foundUser.title,
                        role: foundUser.role_ref,
                        email: foundUser.email
                    };
                    if(foundUser.id === 'USR_004') currentUser.avatarUrl = 'https://androgov-sa.github.io/AIT/photo/grc.png';
                    else {
                        const nameEn = foundUser.name.en || "User";
                        currentUser.avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(nameEn)}&background=FB4747&color=fff&bold=true`;
                    }
                }
                applyLayoutSettings();
                renderSidebar();
                renderHeader();
            }

            function applyLayoutSettings() {
                const html = document.documentElement;
                html.lang = config.lang;
                html.dir = config.lang === 'ar' ? 'rtl' : 'ltr';
                if (config.theme === 'dark') html.classList.add('dark');
                else html.classList.remove('dark');
                const main = document.querySelector('.main-content-wrapper');
                if (main) {
                    main.classList.remove('md:mr-72', 'md:ml-72');
                    main.classList.add(config.lang === 'ar' ? 'md:mr-72' : 'md:ml-72');
                }
            }

            function renderSidebar() {
                const container = document.getElementById('sidebar-container');
                if (!container) return;
                const dict = layoutTrans[config.lang];
                const isRtl = config.lang === 'ar';
                const currentPath = window.location.pathname.split('/').pop() || 'admin.html';
                const uName = config.lang === 'ar' ? currentUser.name.ar : currentUser.name.en;
                const uTitle = config.lang === 'ar' ? currentUser.title.ar : currentUser.title.en;

                let menuHTML = '';
                menuStructure.forEach(group => {
                    menuHTML += `<div class="px-3 mt-6 mb-2 text-[10px] font-bold text-slate-400 uppercase tracking-wider">${dict.sections[group.section]}</div>`;
                    group.items.forEach(item => {
                        const isActive = currentPath.includes(item.link);
                        const activeClass = isActive ? "bg-brandRed text-white shadow-md shadow-red-500/20" : "text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-brandRed";
                        menuHTML += `
                        <a href="${item.link}" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 ${activeClass}">
                            <div class="w-6 text-center"><i class="fa-solid ${item.icon}"></i></div>
                            <span class="flex-1 truncate">${dict.menu[item.key]}</span>
                        </a>`;
                    });
                });

                container.innerHTML = `
                <aside class="fixed top-0 ${isRtl ? 'right-0 border-l' : 'left-0 border-r'} z-50 h-screen w-72 flex-col hidden md:flex bg-white dark:bg-[#0F172A] border-slate-200 dark:border-slate-800 transition-all duration-300">
                    <div class="h-20 flex items-center px-6 border-b border-slate-100 dark:border-slate-800">
                        <div class="flex items-center gap-3 w-full">
                            <img src="https://ait.sa/wp-content/uploads/2024/03/cropped-Square-Logo.png" class="w-10 h-10 rounded-xl bg-white object-contain shrink-0 shadow-sm border border-slate-100 dark:border-slate-700">
                            <div class="overflow-hidden">
                                <h1 class="font-bold text-sm text-slate-800 dark:text-white font-sans truncate">AndroGov <span class="font-light">System</span></h1>
                                <p class="text-[10px] text-slate-500 uppercase tracking-widest truncate">${dict.sysVer}</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-4">
                        <div class="flex items-center gap-3 p-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-100 dark:border-slate-700">
                            <img src="${currentUser.avatarUrl}" class="w-10 h-10 rounded-full border-2 border-white dark:border-slate-600 object-cover shrink-0">
                            <div class="overflow-hidden flex-1 min-w-0">
                                <p class="text-sm font-bold text-slate-800 dark:text-white truncate">${uName}</p>
                                <p class="text-[10px] text-brandRed font-medium truncate">${uTitle}</p>
                            </div>
                        </div>
                    </div>
                    <nav class="flex-1 overflow-y-auto px-3 py-2 custom-scroll space-y-0.5">${menuHTML}</nav>
                    <div class="p-4 text-center text-[10px] text-slate-400 border-t border-slate-100 dark:border-slate-800">Â© 2026 Andromeda IT</div>
                </aside>`;
            }

            function renderHeader() {
                const container = document.getElementById('header-container');
                if (!container) return;
                const dict = layoutTrans[config.lang];
                container.innerHTML = `
                <header class="h-20 sticky top-0 z-40 flex items-center justify-between px-6 bg-white/80 dark:bg-[#0F172A]/90 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 transition-all no-print">
                    <div class="flex items-center gap-4">
                        <button onclick="document.querySelector('aside').classList.toggle('hidden'); document.querySelector('aside').classList.toggle('flex');" class="md:hidden text-slate-500 dark:text-slate-200 hover:text-brandRed"><i class="fa-solid fa-bars text-xl"></i></button>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="window.changeLang()" class="h-9 px-3 rounded-lg border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 text-xs font-bold text-slate-600 dark:text-white transition">${config.lang === 'ar' ? 'English' : 'Ø¹Ø±Ø¨ÙŠ'}</button>
                        <button onclick="window.changeTheme()" class="w-9 h-9 rounded-lg border border-slate-200 dark:border-slate-700 flex items-center justify-center hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-600 dark:text-yellow-400 transition"><i class="fa-solid ${config.theme === 'dark' ? 'fa-sun' : 'fa-moon'}"></i></button>
                        <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 mx-1"></div>
                        <button onclick="window.doLogout()" class="text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 px-3 py-1.5 rounded-lg text-xs font-bold transition flex items-center gap-2"><i class="fa-solid fa-power-off"></i> <span class="hidden sm:inline">${dict.logout}</span></button>
                    </div>
                </header>`;
            }

            window.changeTheme = function() {
                localStorage.setItem('theme', config.theme === 'dark' ? 'light' : 'dark');
                location.reload();
            };
            window.changeLang = function() {
                localStorage.setItem('lang', config.lang === 'ar' ? 'en' : 'ar');
                location.reload();
            };
            window.doLogout = function() {
                if (confirm(config.lang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ' : 'Are you sure you want to logout?')) {
                    localStorage.removeItem('currentUser');
                    window.location.href = 'https://androgov-sa.github.io/AIT/login.html';
                }
            };

            initLayout();
        })();

        // ==========================================
        // C. DASHBOARD LOGIC (Updated with Data)
        // ==========================================
        const pageContent = {
            ar: {
                pageTitle: "AndroGov | Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©",
                alertTitle: 'Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø·Ù„ÙˆØ¨: Ø§Ø¹ØªÙ…Ø§Ø¯ "Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ"',
                alertDesc: 'Ù…Ø³ÙˆØ¯Ø© Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø³. Ø§Ù„Ø±Ø§ÙØ¹:',
                uploaderName: 'Ø£ÙŠÙ…Ù† Ø§Ù„Ù…ØºØ±Ø¨ÙŠ',
                reviewBtn: 'Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø¹ØªÙ…Ø§Ø¯',
                kpiCapital: 'Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø§Ù„Ù…ØµØ¯Ø±',
                currency: 'Ø±.Ø³',
                fullyPaid: 'Ù…Ø¯ÙÙˆØ¹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„',
                kpiShareholders: 'Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†',
                member: 'Ø¹Ø¶Ùˆ',
                shareholdersList: 'ÙˆØ±Ø«Ø© Ù…Ø­Ù…Ø¯ Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠØŒ Ø´Ø±ÙƒØ© Ø¨ÙŠØ¬ÙŠ...',
                kpiStaff: 'Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†',
                systemOnline: 'Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨ÙƒÙØ§Ø¡Ø©',
                kpiComp: 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„',
                chartTitle: 'Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©',
                opsTitle: 'Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©',
                task1: 'Ø§Ø¹ØªÙ…Ø§Ø¯ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª',
                dueDate: 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚',
                gov: 'Ø­ÙˆÙƒÙ…Ø©',
                taskPayroll: 'Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±ÙˆØ§ØªØ¨ (HR)',
                fromLabel: 'Ù…Ù†',
                senderName: 'Ù…Ù†ØµÙˆØ± Ø§Ù„ÙŠØ§Ù…ÙŠ',
                ops: 'ØªØ´ØºÙŠÙ„',
                task3: 'ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ',
                ministry: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¬Ø§Ø±Ø©',
                legal: 'Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©',
                viewAll: 'Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… (12)',
                auditTitle: 'Ø³Ø¬Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¨Ø§Ø´Ø±',
                // Chart Data
                chartHeirs: 'ÙˆØ±Ø«Ø© Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ',
                chartHesham: 'Ù‡Ø´Ø§Ù… Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ',
                chartBG: 'Ø´Ø±ÙƒØ© Ø¨ÙŠØ¬ÙŠ',
                chartOthers: 'Ø¢Ø®Ø±ÙˆÙ†',
                // Logs
                logBackup: 'ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¨Ù†Ø¬Ø§Ø­',
                logPolicy: 'Ù‚Ø§Ù… Ù‡Ø´Ø§Ù… Ø¨Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª',
                logUpload: 'Ù‚Ø§Ù… Ø£ÙŠÙ…Ù† Ø¨Ø±ÙØ¹ Ù…Ø³ÙˆØ¯Ø© Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ',
                logFirewall: 'ØªÙ… Ø­Ø¸Ø± Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ù…Ø´Ø¨ÙˆÙ‡Ø©'
            },
            en: {
                pageTitle: "AndroGov | Dashboard",
                alertTitle: 'Action Required: Approve "Internal Manual"',
                alertDesc: 'Draft awaiting final Board approval. Uploader:',
                uploaderName: 'Ayman Almaghrabi',
                reviewBtn: 'Review & Approve',
                kpiCapital: 'Issued Capital',
                currency: 'SAR',
                fullyPaid: 'Fully Paid',
                kpiShareholders: 'Shareholders',
                member: 'Members',
                shareholdersList: 'Heirs of Al-Suhaibani, BG Company...',
                kpiStaff: 'Active Employees',
                systemOnline: 'System Operational',
                kpiComp: 'Compliance Rate',
                chartTitle: 'Ownership Structure',
                opsTitle: 'Operational Tasks',
                task1: 'Approve Bonus Policy',
                dueDate: 'Due Date',
                gov: 'Gov',
                taskPayroll: 'Review Payroll Report (HR)',
                fromLabel: 'From',
                senderName: 'Mansour Alyami',
                ops: 'Ops',
                task3: 'Update Commercial Registry',
                ministry: 'Ministry of Commerce',
                legal: 'Legal',
                viewAll: 'View All Tasks (12)',
                auditTitle: 'Live System Audit',
                // Chart Data
                chartHeirs: 'Heirs of Al-Suhaibani',
                chartHesham: 'Hesham Al-Suhaibani',
                chartBG: 'BG LTD',
                chartOthers: 'Others',
                // Logs
                logBackup: 'Backup completed successfully',
                logPolicy: 'Hesham viewed Bonus Policy',
                logUpload: 'Ayman uploaded Internal Manual draft',
                logFirewall: 'Suspicious login attempt blocked'
            }
        };

        function initPage() {
            const lang = localStorage.getItem('lang') || 'ar';
            const t = pageContent[lang];
            
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

            // Text Update
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if(t[key]) el.innerText = t[key];
            });

            // Update Counts from Data
            document.getElementById('shareholder-count').innerHTML = SYSTEM_DATA.shareholders.length + ` <span class="text-xs font-sans text-slate-400">${t.member}</span>`;
            document.getElementById('staff-count').innerText = SYSTEM_DATA.users.length;

            // Chart
            const ctx = document.getElementById('ownershipChart').getContext('2d');
            const data = {
                labels: [t.chartHeirs, t.chartHesham, t.chartBG, t.chartOthers],
                datasets: [{
                    data: [35, 10, 10, 45],
                    backgroundColor: ['#FB4747', '#4267B2', '#10B981', '#CBD5E1'],
                    borderWidth: 0,
                    hoverOffset: 10
                }]
            };
            
            // Clear existing chart if any (simple approach)
            if(window.myChart) window.myChart.destroy();
            window.myChart = new Chart(ctx, {
                type: 'doughnut',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    cutout: '75%'
                }
            });

            // Custom Legend
            document.getElementById('chartLegend').innerHTML = `
                <div class="flex justify-between items-center text-xs">
                    <span class="flex items-center gap-2 text-slate-600 dark:text-slate-300"><span class="w-2 h-2 rounded-full bg-brandRed"></span> ${t.chartHeirs}</span>
                    <span class="font-bold font-en">35%</span>
                </div>
                <div class="flex justify-between items-center text-xs">
                    <span class="flex items-center gap-2 text-slate-600 dark:text-slate-300"><span class="w-2 h-2 rounded-full bg-blue-500"></span> ${t.chartHesham}</span>
                    <span class="font-bold font-en">10%</span>
                </div>
                <div class="flex justify-between items-center text-xs">
                    <span class="flex items-center gap-2 text-slate-600 dark:text-slate-300"><span class="w-2 h-2 rounded-full bg-green-500"></span> ${t.chartBG}</span>
                    <span class="font-bold font-en">10%</span>
                </div>
                <div class="flex justify-between items-center text-xs">
                    <span class="flex items-center gap-2 text-slate-600 dark:text-slate-300"><span class="w-2 h-2 rounded-full bg-slate-300"></span> ${t.chartOthers}</span>
                    <span class="font-bold font-en">45%</span>
                </div>
            `;

            // Logs
            const logs = [
                { t: "10:45:22", type: "INFO", u: "System", msg: t.logBackup, c: "text-green-400" },
                { t: "10:42:15", type: "WARN", u: "Hesham", msg: t.logPolicy, c: "text-yellow-400" },
                { t: "10:30:01", type: "INFO", u: "Ayman", msg: t.logUpload, c: "text-blue-400" },
                { t: "09:15:00", type: "CRIT", u: "Firewall", msg: t.logFirewall, c: "text-red-400" }
            ];
            const logContainer = document.getElementById('audit-log-container');
            logContainer.innerHTML = '';
            logs.forEach(log => {
                logContainer.innerHTML += `
                    <div class="flex gap-3 hover:bg-slate-800/50 p-1 rounded transition cursor-default">
                        <span class="text-slate-500 w-16 shrink-0">[${log.t}]</span>
                        <span class="${log.c} font-bold w-10 shrink-0">${log.type}</span>
                        <span class="text-white w-16 shrink-0 font-bold">${log.u}</span>
                        <span class="text-slate-400 truncate">${log.msg}</span>
                    </div>
                `;
            });
        }

        // Chatbot logic
        document.getElementById('chat-fab').addEventListener('click', () => {
            const w = document.getElementById('chat-window');
            w.classList.remove('hidden');
            w.classList.add('flex');
        });
        document.getElementById('close-chat-btn').addEventListener('click', () => {
            const w = document.getElementById('chat-window');
            w.classList.add('hidden');
            w.classList.remove('flex');
        });

        // Run
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
