<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#FB4747">
    <title id="pageTitle">ุจูุงุจุฉ ุงููุฌูุณ | AndroGov</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { brandRed: '#FB4747', brandBlue: '#4267B2', brandDark: '#1E293B', brandGray: '#F8FAFC' },
                    fontFamily: { sans: ['Tajawal', 'Inter', 'sans-serif'], en: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        .num-font { font-family: 'Inter', sans-serif; direction: ltr; display: inline-block; }
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
        /* Animation Classes */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>

<body class="bg-brandGray dark:bg-slate-900 text-slate-800 dark:text-slate-100 font-sans h-screen flex overflow-hidden">

    <div id="sidebar-container"></div>

    <div class="flex-1 flex flex-col h-full relative transition-all duration-300 ltr:md:ml-72 rtl:md:mr-72">
        
        <div id="header-container"></div>

        <main class="flex-1 overflow-y-auto p-6 custom-scroll" id="main-content">
            
            <div id="view-dashboard" class="space-y-6 fade-in">
                <div class="bg-gradient-to-r from-slate-900 to-slate-800 rounded-3xl p-8 text-white relative overflow-hidden shadow-xl">
                    <div class="relative z-10">
                        <h1 class="text-2xl font-bold mb-2">ูุฑุญุจุงูุ <span id="dashName">ุณุนุงุฏุฉ ุงูุนุถู</span> ๐</h1>
                        <p class="text-slate-300 text-sm opacity-90">ููุฎุต ุฃุนูุงู ุงููุฌูุณ ูุงููุฌุงู ููุฏูุฑุฉ ุงูุญุงููุฉ.</p>
                        <div class="mt-6 flex gap-3">
                            <button onclick="BoardLayout.switchView('meetings')" class="bg-brandBlue px-6 py-2 rounded-xl font-bold text-sm shadow-lg hover:bg-blue-600 transition flex items-center gap-2">
                                <i class="fa-regular fa-calendar"></i> ุงูุงุฌุชูุงุนุงุช
                            </button>
                            <button onclick="BoardLayout.switchView('resolutions')" class="bg-white/10 px-6 py-2 rounded-xl font-bold text-sm backdrop-blur-md hover:bg-white/20 transition flex items-center gap-2">
                                <i class="fa-solid fa-check-to-slot"></i> ุงูุชุตููุช
                            </button>
                        </div>
                    </div>
                    <div class="absolute -bottom-10 -left-10 w-40 h-40 bg-brandRed/20 rounded-full blur-3xl"></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md transition">
                        <div class="flex justify-between mb-4">
                            <div class="w-10 h-10 bg-red-50 text-red-500 rounded-lg flex items-center justify-center"><i class="fa-solid fa-gavel"></i></div>
                            <span class="text-[10px] bg-red-50 text-red-600 px-2 py-1 rounded-full font-bold h-fit animate-pulse">ุนุงุฌู</span>
                        </div>
                        <h3 class="text-3xl font-bold num-font">2</h3>
                        <p class="text-xs text-slate-400 mt-1">ูุฑุงุฑุงุช ุจุงูุชุธุงุฑ ุงูุชุตููุช</p>
                    </div>
                    <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md transition">
                        <div class="flex justify-between mb-4">
                            <div class="w-10 h-10 bg-blue-50 text-brandBlue rounded-lg flex items-center justify-center"><i class="fa-solid fa-calendar-check"></i></div>
                        </div>
                        <h3 class="text-3xl font-bold num-font">95%</h3>
                        <p class="text-xs text-slate-400 mt-1">ูุณุจุฉ ุงูุญุถูุฑ ุงูุณููู</p>
                    </div>
                    <div class="bg-white dark:bg-slate-800 p-5 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md transition">
                        <div class="flex justify-between mb-4">
                            <div class="w-10 h-10 bg-green-50 text-green-600 rounded-lg flex items-center justify-center"><i class="fa-solid fa-chart-line"></i></div>
                        </div>
                        <h3 class="text-3xl font-bold num-font">14%</h3>
                        <p class="text-xs text-slate-400 mt-1">ููู ุงูุฃุฑุจุงุญ (Q4)</p>
                    </div>
                </div>

                <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold dark:text-white">ุชุญููู ุฃุฏุงุก ุงููุฑุงุฑุงุช</h3>
                        <button class="text-xs text-slate-400 hover:text-brandRed"><i class="fa-solid fa-download"></i> ุชุตุฏูุฑ</button>
                    </div>
                    <div class="h-64 w-full relative">
                        <canvas id="boardChart"></canvas>
                    </div>
                </div>
            </div>

            <div id="view-meetings" class="hidden fade-in">
                <div class="bg-white dark:bg-slate-800 p-10 rounded-2xl text-center">
                    <i class="fa-regular fa-calendar-days text-4xl text-slate-300 mb-4"></i>
                    <h3 class="font-bold text-lg dark:text-white">ุฌุฏูู ุงูุงุฌุชูุงุนุงุช</h3>
                    <p class="text-slate-400 text-sm mt-2">ูุง ุชูุฌุฏ ุงุฌุชูุงุนุงุช ูุฌุฏููุฉ ููุฐุง ุงูุฃุณุจูุน.</p>
                    <button onclick="BoardLayout.switchView('dashboard')" class="mt-4 text-brandRed text-sm hover:underline">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                </div>
            </div>

            <div id="view-resolutions" class="hidden fade-in">
                <div class="bg-white dark:bg-slate-800 p-10 rounded-2xl text-center">
                    <i class="fa-solid fa-check-to-slot text-4xl text-slate-300 mb-4"></i>
                    <h3 class="font-bold text-lg dark:text-white">ุณุฌู ุงููุฑุงุฑุงุช</h3>
                    <p class="text-slate-400 text-sm mt-2">ุฌุงุฑู ุชุญููู ุจูุงูุงุช ุงูุชุตููุช...</p>
                    <button onclick="BoardLayout.switchView('dashboard')" class="mt-4 text-brandRed text-sm hover:underline">ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ</button>
                </div>
            </div>
        </main>
    </div>

    <script src="../admin/js/core/config.js"></script>
    <script src="../admin/js/core/i18n.js"></script>
    <script src="../admin/js/services/data-service.js"></script>
    <script src="../admin/js/components/role-switcher.js"></script>
    
    <script src="../admin/js/components/layout.js"></script>
    <script src="../admin/js/components/bot.js"></script>

    <script>
        // ==========================================
        // 1. Board Logic (Switching Views & Chart)
        // ==========================================
        const BoardLayout = {
            activeView: 'dashboard',
            
            switchView: function(viewId) {
                // ุฅุฎูุงุก ุงููู
                ['dashboard', 'meetings', 'resolutions'].forEach(id => {
                    document.getElementById(`view-${id}`).classList.add('hidden');
                });
                // ุฅุธูุงุฑ ุงููุทููุจ
                const target = document.getElementById(`view-${viewId}`);
                if(target) {
                    target.classList.remove('hidden');
                    // ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฃููููุดู
                    target.classList.remove('fade-in');
                    void target.offsetWidth; // trigger reflow
                    target.classList.add('fade-in');
                }
                this.activeView = viewId;
            },

            initChart: function() {
                const ctx = document.getElementById('boardChart');
                if(!ctx) return;
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['ููุงูุฑ', 'ูุจุฑุงูุฑ', 'ูุงุฑุณ', 'ุฃุจุฑูู', 'ูุงูู', 'ููููู'],
                        datasets: [
                            {
                                label: 'ูุฑุงุฑุงุช ูุนุชูุฏุฉ',
                                data: [12, 19, 3, 5, 2, 3],
                                backgroundColor: '#10B981',
                                borderRadius: 4
                            },
                            {
                                label: 'ูุคุฌูุฉ',
                                data: [2, 3, 20, 5, 1, 4],
                                backgroundColor: '#FB4747',
                                borderRadius: 4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { font: { family: 'Tajawal' } } }
                        },
                        scales: {
                            y: { beginAtZero: true, grid: { color: '#e2e8f0' } },
                            x: { grid: { display: false } }
                        }
                    }
                });
            }
        };

        // ==========================================
        // 2. Initialization
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            
            // ุงูุชุธุงุฑ ุชุญููู ุงูููุชุจุงุช ุงูุฃุณุงุณูุฉ
            const checkLibs = setInterval(() => {
                if (typeof Layout !== 'undefined' && typeof AppConfig !== 'undefined') {
                    clearInterval(checkLibs);

                    // โ ุชุตุญูุญ: ุงุณุชุฎุฏุงู "type" ุงูุตุบูุฑ ูุถูุงู ุนูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
                    const boardUser = {
                        id: 'BRD_001',
                        type: 'board', // โ๏ธ ููู ุฌุฏุงู: ูุฌุจ ุฃู ูููู lowercase ูุทุงุจูุงู ูู roleMap
                        role: 'Board Member',
                        displayName: 'ุฏ. ุนุจุฏุงููู ุงูุญูุงุณ',
                        displayTitle: 'ุฑุฆูุณ ูุฌูุณ ุงูุฅุฏุงุฑุฉ',
                        avatar: 'https://ui-avatars.com/api/?name=A+H&background=FB4747&color=fff'
                    };

                    // ุชุญุฏูุซ ุงูุงุณู ูู ุงููุงุฌูุฉ
                    document.getElementById('dashName').innerText = boardUser.displayName;

                    // ุชุดุบูู ุงููุธุงู
                    AppConfig.setCurrentUser(boardUser);
                    Layout.init();
                    
                    // ุชุดุบูู ุงูุดุงุฑุช
                    BoardLayout.initChart();
                }
            }, 50);
        });
    </script>

</body>
</html>
