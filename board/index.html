<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#FB4747">
    <title data-i18n="pageTitle">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¬Ù„Ø³ | AndroGov</title>
    
    <!-- Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 
                        brandRed: '#FB4747', 
                        brandBlue: '#4267B2', 
                        brandDark: '#0F172A', 
                        brandGray: '#F8FAFC' 
                    },
                    fontFamily: { 
                        sans: ['Tajawal', 'Inter', 'sans-serif'],
                        en: ['Inter', 'sans-serif'] 
                    }
                }
            }
        }
    </script>
    <style>
        .num-font { font-family: 'Inter', sans-serif; direction: ltr; display: inline-block; }
        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 10px; }
        .main-content-wrapper { transition: all 0.3s ease-in-out; }
        .glass-effect { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); }
        .shadow-glow { box-shadow: 0 10px 15px -3px rgba(251, 71, 71, 0.3); }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Sidebar Active Dot */
        .active-dot { width: 6px; height: 6px; border-radius: 50%; background-color: white; }
    </style>
</head>

<body class="bg-brandGray dark:bg-[#0F172A] text-slate-800 dark:text-slate-100 font-sans h-screen flex overflow-hidden">

    <!-- âœ… Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-white dark:bg-[#0F172A] z-[9999] flex items-center justify-center transition-opacity duration-500">
        <div class="text-center">
            <div class="w-16 h-16 border-4 border-brandRed border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
            <p class="text-sm text-slate-600 dark:text-slate-400 font-bold" data-i18n="loading">Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…Ù„ ÙˆØªØ­Ù…ÙŠÙ„ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø­ÙˆÙƒÙ…Ø©...</p>
        </div>
    </div>

    <!-- âœ… Sidebar Container -->
    <div id="sidebar-container"></div>

    <!-- âœ… Main Layout Wrapper -->
    <div class="main-content-wrapper flex-1 flex flex-col h-full relative overflow-hidden md:mr-72">
        
        <div id="header-container"></div>

        <main class="flex-1 overflow-y-auto p-6 custom-scroll space-y-6 fade-in">
            
            <!-- Welcome Banner -->
            <div class="bg-slate-900 text-white p-10 rounded-[2.5rem] shadow-xl relative overflow-hidden border-b-8 border-brandRed">
                <div class="relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                    <div>
                        <h1 class="text-3xl font-extrabold mb-2">
                            <span data-i18n="welcome">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ</span> 
                            <span id="dynamicName" class="text-brandRed">Ø³Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø¶Ùˆ</span>
                        </h1>
                        <p class="text-slate-400 text-base" id="dynamicTitle">Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ù„Ø¬Ù†Ø© Ø§Ù„ØªØ±Ø´ÙŠØ­Ø§Øª ÙˆØ§Ù„Ù…ÙƒØ§ÙØ¢Øª</p>
                    </div>
                    <div id="secretaryActions" class="hidden flex gap-3">
                        <button class="bg-brandRed px-6 py-3 rounded-2xl text-sm font-bold shadow-lg shadow-brandRed/30 hover:bg-red-700 transition flex items-center gap-2">
                            <i class="fa-solid fa-plus-circle"></i> <span data-i18n="btnNewAgenda">Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø¬Ù†Ø¯Ø© Ø§Ø¬ØªÙ…Ø§Ø¹ Ø¬Ø¯ÙŠØ¯</span>
                        </button>
                    </div>
                </div>
                <div class="absolute -bottom-20 -left-20 w-64 h-64 bg-brandRed/10 rounded-full blur-[100px]"></div>
                <div class="absolute top-0 right-0 p-10 opacity-5 pointer-events-none">
                    <i class="fa-solid fa-building-columns text-[15rem]"></i>
                </div>
            </div>

            <!-- Dashboard Statistics -->
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-700 group hover:border-brandRed transition-all">
                    <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1" data-i18n="statDecisions">Ø­Ø§Ù„Ø© Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª</p>
                    <h3 class="text-3xl font-black num-font text-brandRed">02 <span class="text-sm text-slate-500 font-normal" data-i18n="statPending">Ù…Ø¹Ù„Ù‚Ø©</span></h3>
                </div>
                <div class="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-700 group hover:border-brandBlue transition-all">
                    <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1" data-i18n="statMeeting">Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ù‚Ø§Ø¯Ù…</p>
                    <h3 class="text-xl font-bold text-blue-600 flex items-center gap-2">
                        <i class="fa-solid fa-calendar-day text-sm"></i> 22 <span data-i18n="statFeb">ÙØ¨Ø±Ø§ÙŠØ±</span> 2026
                    </h3>
                </div>
                <div class="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-700 group hover:border-green-500 transition-all">
                    <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1" data-i18n="statAttendance">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø­Ø¶ÙˆØ±</p>
                    <h3 class="text-3xl font-black num-font text-green-600">92%</h3>
                </div>
                <div class="bg-white dark:bg-slate-800 p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-700 group hover:border-slate-400 transition-all">
                    <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-1" data-i18n="statFiles">Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„ÙÙ†ÙŠØ©</p>
                    <h3 class="text-3xl font-black num-font text-slate-400">24</h3>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Recent Files Section -->
                <div class="lg:col-span-2">
                    <div class="bg-white dark:bg-slate-800 rounded-[2rem] shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden">
                        <div class="p-6 border-b border-slate-50 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50 flex justify-between items-center">
                            <h3 class="font-bold text-sm flex items-center gap-2">
                                <i class="fa-solid fa-folder-open text-brandRed"></i>
                                <span data-i18n="titleRecentFiles">Ø¢Ø®Ø± Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</span>
                            </h3>
                            <button class="text-[10px] font-bold text-brandBlue uppercase tracking-widest hover:underline">Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙƒØªØ¨Ø©</button>
                        </div>
                        <div class="p-6 space-y-4">
                            <!-- File 1 -->
                            <div class="flex items-center justify-between p-5 bg-slate-50 dark:bg-slate-900/50 rounded-2xl border border-slate-100 dark:border-slate-700 group hover:border-brandRed hover:shadow-md transition-all">
                                <div class="flex items-center gap-5">
                                    <div class="w-12 h-12 bg-white dark:bg-slate-800 rounded-xl flex items-center justify-center text-brandRed shadow-sm group-hover:scale-110 transition-transform">
                                        <i class="fa-solid fa-file-pdf text-2xl"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm font-bold text-slate-800 dark:text-white" data-i18n="file1">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­ÙˆÙƒÙ…Ø© Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ø¹Ø§Ù… 2025 - Ù…Ø³ÙˆØ¯Ø© Ù†Ù‡Ø§Ø¦ÙŠØ©</p>
                                        <p class="text-[10px] text-slate-400 mt-1">Ø±ÙØ¹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø£Ù…ÙŠÙ† Ø§Ù„Ø³Ø± â€¢ <span class="num-font">14:20</span> â€¢ Ù…Ù†Ø° Ø³Ø§Ø¹ØªÙŠÙ†</p>
                                    </div>
                                </div>
                                <div class="flex gap-2">
                                    <button class="w-10 h-10 rounded-xl bg-white dark:bg-slate-800 text-slate-400 hover:text-brandRed shadow-sm border border-slate-100 dark:border-slate-700 transition-all flex items-center justify-center">
                                        <i class="fa-solid fa-download"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- File 2 -->
                            <div class="flex items-center justify-between p-5 bg-slate-50 dark:bg-slate-900/50 rounded-2xl border border-slate-100 dark:border-slate-700 group hover:border-green-600 hover:shadow-md transition-all">
                                <div class="flex items-center gap-5">
                                    <div class="w-12 h-12 bg-white dark:bg-slate-800 rounded-xl flex items-center justify-center text-green-600 shadow-sm group-hover:scale-110 transition-transform">
                                        <i class="fa-solid fa-file-excel text-2xl"></i>
                                    </div>
                                    <div>
                                        <p class="text-sm font-bold text-slate-800 dark:text-white" data-i18n="file2">Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ ÙˆØ§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©</p>
                                        <p class="text-[10px] text-slate-400 mt-1">ØªÙ… Ø§Ù„Ø¥Ø¹ØªÙ…Ø§Ø¯ Ù…Ù† Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© â€¢ Ù…Ù†Ø° ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯</p>
                                    </div>
                                </div>
                                <div class="flex gap-2">
                                    <button class="w-10 h-10 rounded-xl bg-white dark:bg-slate-800 text-slate-400 hover:text-green-600 shadow-sm border border-slate-100 dark:border-slate-700 transition-all flex items-center justify-center">
                                        <i class="fa-solid fa-check-double"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Signatures & Reminder Section -->
                <div class="space-y-6">
                    <!-- Signatures Card -->
                    <div class="bg-white dark:bg-slate-800 p-8 rounded-[2rem] shadow-sm border border-slate-100 dark:border-slate-700">
                        <h3 class="font-bold text-sm mb-6 flex items-center gap-2" data-i18n="titleSignatures">
                            <i class="fa-solid fa-signature text-brandBlue"></i> Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹ Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
                        </h3>
                        <div class="space-y-4">
                            <div class="flex justify-between text-[11px] mb-1 font-bold">
                                <span data-i18n="signatureDesc">Ù…Ø­Ø¶Ø± Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø±Ù‚Ù… (41):</span>
                                <span class="text-brandBlue num-font">75%</span>
                            </div>
                            <div class="w-full bg-slate-100 dark:bg-slate-700 h-3 rounded-full overflow-hidden shadow-inner">
                                <div class="bg-gradient-to-r from-brandBlue to-blue-600 h-full transition-all duration-[1.5s] ease-out" style="width: 75%"></div>
                            </div>
                            <p class="text-[10px] text-center text-slate-400 font-medium" data-i18n="signatureCount">ØªÙ… ØªÙˆÙ‚ÙŠØ¹ 7 Ù…Ù† Ø£ØµÙ„ 9 Ø£Ø¹Ø¶Ø§Ø¡</p>
                        </div>
                    </div>

                    <!-- Important Reminder Card -->
                    <div class="bg-gradient-to-br from-brandRed to-red-600 p-8 rounded-[2rem] shadow-2xl text-white relative overflow-hidden">
                        <div class="relative z-10">
                            <div class="flex items-center gap-4 mb-5">
                                <div class="w-12 h-12 rounded-2xl bg-white/20 backdrop-blur-md flex items-center justify-center border border-white/20">
                                    <i class="fa-solid fa-bell-concierge text-xl"></i>
                                </div>
                                <h3 class="font-extrabold text-lg tracking-tight" data-i18n="titleReminder">ØªØ°ÙƒÙŠØ± Ù‡Ø§Ù… ÙˆØ¹Ø§Ø¬Ù„</h3>
                            </div>
                            <p class="text-sm text-white/90 leading-relaxed font-medium" data-i18n="reminderText">
                                Ø³Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø¶ÙˆØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¹Ù„Ù‰ "Ù‚Ø±Ø§Ø± Ø§Ù„ØªÙ…Ø±ÙŠØ±" Ø§Ù„Ø®Ø§Øµ Ø¨ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³ØªØ´Ø§Ø± Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙˆØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ù„Ø­Ù‚ Ø§Ù„ÙÙ†ÙŠ Ù‚Ø¨Ù„ Ù†Ù‡Ø§ÙŠØ© Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….
                            </p>
                            <button onclick="window.location.href='#'" class="w-full mt-6 py-3.5 bg-white text-brandRed rounded-2xl text-xs font-black uppercase tracking-widest shadow-xl hover:bg-slate-50 transition-all flex items-center justify-center gap-3">
                                <span data-i18n="btnReview">Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø±</span> 
                                <i class="fa-solid fa-arrow-left-long"></i>
                            </button>
                        </div>
                        <!-- Decorative Circle -->
                        <div class="absolute -top-10 -right-10 w-32 h-32 bg-white/5 rounded-full"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- âœ… 1. Assistant Logic (AndroBot) -->
    <script>
    const AndroBot = (function() {
        let _isOpen = false, _container = null;
        function _init() {
            if (_container) return;
            _container = document.createElement('div');
            _container.id = 'bot-portal';
            _container.className = 'fixed bottom-8 left-8 z-[9999] transition-all duration-500 transform';
            _container.innerHTML = `
                <div id="bot-chat" class="absolute bottom-24 left-0 w-80 h-[450px] bg-white dark:bg-slate-800 rounded-[2.5rem] shadow-2xl border-2 border-slate-100 dark:border-slate-700 flex flex-col overflow-hidden opacity-0 scale-90 pointer-events-none transition-all duration-300 origin-bottom-left glass-effect">
                    <div class="p-6 bg-gradient-to-r from-brandBlue to-blue-700 text-white flex justify-between items-center shadow-lg">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg bg-white/20 flex items-center justify-center"><i class="fa-solid fa-robot"></i></div>
                            <span class="font-black text-xs uppercase tracking-widest">AndroBot Executive</span>
                        </div>
                        <button onclick="AndroBot.toggle()"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                    <div id="bot-messages" class="flex-1 p-5 overflow-y-auto bg-slate-50/50 dark:bg-slate-900/50 custom-scroll space-y-4">
                        <div class="text-right"><div class="inline-block p-3 rounded-2xl rounded-tr-none bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700 text-[11px] leading-relaxed">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ø³Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø¶ÙˆØŒ Ø£Ù†Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù†Ø¸Ø§Ù… AndroGov. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„ÙŠÙˆÙ…ØŸ</div></div>
                    </div>
                    <div class="p-4 border-t border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800">
                        <input type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ù‡Ù†Ø§..." class="w-full px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-[10px] outline-none focus:border-brandBlue transition-all">
                    </div>
                </div>
                <button onclick="AndroBot.toggle()" class="w-16 h-16 rounded-[22px] bg-gradient-to-br from-brandBlue to-blue-700 text-white shadow-2xl flex items-center justify-center border-4 border-white dark:border-slate-800 hover:scale-110 active:scale-95 transition-all">
                    <i class="fa-solid fa-robot text-2xl"></i>
                    <span class="absolute -top-1 -right-1 w-4 h-4 bg-green-500 border-2 border-white dark:border-slate-800 rounded-full"></span>
                </button>`;
            document.body.appendChild(_container);
        }
        return {
            toggle: function() {
                _init();
                _isOpen = !_isOpen;
                const chat = document.getElementById('bot-chat');
                if (_isOpen) {
                    chat.classList.remove('opacity-0', 'scale-90', 'pointer-events-none');
                    chat.classList.add('opacity-100', 'scale-100');
                } else {
                    chat.classList.add('opacity-0', 'scale-90', 'pointer-events-none');
                    chat.classList.remove('opacity-100', 'scale-100');
                }
            }
        };
    })();
    </script>

    <!-- âœ… 2. Layout Master Engine (THE 1540-LINE LOGIC RESTORED) -->
    <script>
    const Layout = (function() {
        // â•â• STATE & CONFIG â•â•
        let _state = {
            currentUser: null,
            activeRole: 'board_secretary',
            theme: localStorage.getItem('theme') || 'light',
            isInitialized: false,
            sidebarOpen: false,
            notifications: [],
            unreadCount: 0
        };

        // â•â• COMPLETE MENU DEFINITIONS (AS REQUESTED) â•â•
        const _menuDefinitions = {
            'admin': [
                { section: 'core_system', items: [
                    { key: 'dashboard', icon: 'fa-gauge-high', link: 'index.html', badge: null },
                    { key: 'users_mgmt', icon: 'fa-users-gear', link: 'users.html', badge: 'core' },
                    { key: 'admin_settings', icon: 'fa-sliders', link: 'admin_settings.html', badge: null }
                ]},
                { section: 'infrastructure', items: [
                    { key: 'it_systems', icon: 'fa-microchip', link: 'it.html', badge: 'tech' },
                    { key: 'system_audit', icon: 'fa-terminal', link: 'audit.html', badge: null }
                ]},
                { section: 'communication', items: [
                    { key: 'internal_chat', icon: 'fa-comments', link: 'admin_chat.html', badge: 'new' }
                ]}
            ],
            'board_secretary': [
                { section: 'board_operations', items: [
                    { key: 'dashboard', icon: 'fa-gauge-high', link: 'index.html', badge: 'live' },
                    { key: 'meetings', icon: 'fa-calendar-check', link: 'board.html', badge: null },
                    { key: 'committees_mgmt', icon: 'fa-people-group', link: 'committees.html', badge: null },
                    { key: 'general_assembly', icon: 'fa-users-rectangle', link: 'ga.html', badge: 'GA' }
                ]},
                { section: 'governance_docs', items: [
                    { key: 'policies_library', icon: 'fa-book-open', link: 'policies.html', badge: null },
                    { key: 'board_circulars', icon: 'fa-scroll', link: 'circulars.html', badge: null }
                ]},
                { section: 'personal', items: [
                    { key: 'my_profile', icon: 'fa-user-circle', link: 'profile.html', badge: null }
                ]}
            ],
            'audit_secretary': [
                { section: 'audit_oversight', items: [
                    { key: 'audit_dashboard', icon: 'fa-magnifying-glass-chart', link: 'audit.html', badge: 'audit' },
                    { key: 'financial_review', icon: 'fa-money-bill-trend-up', link: 'finance.html', badge: null },
                    { key: 'procurement_control', icon: 'fa-boxes-packing', link: 'procurement.html', badge: 'orders' }
                ]}
            ],
            'investor_relations': [
                { section: 'shareholders', items: [
                    { key: 'shareholders_db', icon: 'fa-id-card', link: 'shareholders.html', badge: 'IR' },
                    { key: 'ga_access', icon: 'fa-landmark', link: 'ga.html', badge: null }
                ]}
            ],
            'grc_officer': [
                { section: 'grc_compliance', items: [
                    { key: 'compliance_dashboard', icon: 'fa-scale-balanced', link: 'compliance.html', badge: 'grc' },
                    { key: 'doa_authority', icon: 'fa-sitemap', link: 'doa.html', badge: 'authority' }
                ]}
            ]
        };

        const _roleLabels = {
            'admin': { ar: 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…', en: 'System Admin', desc: { ar: 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ© ÙˆØ§Ù„Ø±Ù‚Ø§Ø¨Ø©', en: 'Technical Management' } },
            'board_secretary': { ar: 'Ø£Ù…ÙŠÙ† Ø³Ø± Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', en: 'Board Secretary', desc: { ar: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ù„Ø³ ÙˆØ§Ù„Ù„Ø¬Ø§Ù† ÙˆØ§Ù„Ø¬Ù…Ø¹ÙŠØ§Øª', en: 'Board & Committee Management' } },
            'audit_secretary': { ar: 'Ø£Ù…ÙŠÙ† Ø³Ø± Ù„Ø¬Ù†Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', en: 'Audit Committee', desc: { ar: 'Ø§Ù„Ø±Ù‚Ø§Ø¨Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ', en: 'Financial Audit & Control' } },
            'investor_relations': { ar: 'Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø³Ø§Ù‡Ù…ÙŠÙ†', en: 'Investor Relations', desc: { ar: 'Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ† ÙˆØ§Ù„Ù…Ù„Ø§Ùƒ', en: 'Shareholder Data' } },
            'grc_officer': { ar: 'Ù…Ø³Ø¤ÙˆÙ„ GRC ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„', en: 'GRC Officer', desc: { ar: 'Ø§Ù„Ø­ÙˆÙƒÙ…Ø© ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù…', en: 'Governance, Risk & Compliance' } }
        };

        const _translations = {
            ar: {
                core_system: 'Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ', infrastructure: 'Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©', communication: 'Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª', board_operations: 'Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¬Ù„Ø³', governance_docs: 'ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø­ÙˆÙƒÙ…Ø©', personal: 'Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø®ØµÙŠ', dashboard: 'Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©', users_mgmt: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', admin_settings: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…', it_systems: 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ©', system_audit: 'Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚', internal_chat: 'Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©', circulars_admin: 'Ø§Ù„ØªØ¹Ø§Ù…ÙŠÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©', meetings: 'Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹Ø§Øª', committees_mgmt: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù„Ø¬Ø§Ù†', general_assembly: 'Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©', policies_library: 'Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª', board_circulars: 'ØªØ¹Ø§Ù…ÙŠÙ… Ø§Ù„Ù…Ø¬Ù„Ø³', my_profile: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', logout: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', notifications: 'Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª', markAllRead: 'ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡', welcome: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ', loading: 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¬Ù„Ø³...', switchWorkspace: 'ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¹Ù…Ù„', selectRole: 'Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù…Ù‡Ø§Ù…Ùƒ', noNotifications: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©'
            },
            en: {
                core_system: 'Core System', infrastructure: 'Infrastructure', communication: 'Communications', board_operations: 'Board Operations', governance_docs: 'Governance Docs', personal: 'Personal', dashboard: 'Dashboard', users_mgmt: 'Users Mgmt', admin_settings: 'Settings', it_systems: 'IT Systems', system_audit: 'Audit Log', internal_chat: 'Internal Chat', circulars_admin: 'Admin Circulars', meetings: 'Meetings', committees_mgmt: 'Committees', general_assembly: 'General Assembly', policies_library: 'Policies', board_circulars: 'Circulars', my_profile: 'Profile', logout: 'Logout', notifications: 'Notifications', markAllRead: 'Mark all read', welcome: 'Welcome,', loading: 'Loading Board Portal...', switchWorkspace: 'Switch Workspace', selectRole: 'Select Role', noNotifications: 'No new notifications'
            }
        };

        // â•â• CORE LOGIC â•â•
        function getCurrentLang() { return localStorage.getItem('lang') || 'ar'; }
        function t(key) { return _translations[getCurrentLang()]?.[key] || key; }

        function applyTheme() {
            document.documentElement.classList.toggle('dark', _state.theme === 'dark');
        }

        function toggleTheme() {
            _state.theme = _state.theme === 'dark' ? 'light' : 'dark';
            localStorage.setItem('theme', _state.theme);
            applyTheme();
            renderHeader();
        }

        function loadNotifications() {
            _state.notifications = [
                { id: 'N001', type: 'approval', icon: 'fa-file-signature', color: 'orange', title: { ar: 'ØªÙˆÙ‚ÙŠØ¹ Ù…Ø·Ù„ÙˆØ¨', en: 'Signature Required' }, body: { ar: 'Ù…Ø­Ø¶Ø± Ø§Ø¬ØªÙ…Ø§Ø¹ Ø±Ù‚Ù… 41', en: 'Meeting Minutes #41' }, time: new Date(), read: false }
            ];
            _state.unreadCount = _state.notifications.filter(n => !n.read).length;
        }

        function renderSidebar() {
            const container = document.getElementById('sidebar-container');
            if (!container) return;
            const lang = getCurrentLang();
            const isRTL = lang === 'ar';
            const menu = _menuDefinitions[_state.activeRole];
            const currentPath = window.location.pathname.split('/').pop() || 'index.html';
            
            let html = `
            <aside id="main-sidebar" class="fixed top-0 ${isRTL ? 'right-0 border-l' : 'left-0 border-r'} z-50 h-screen w-72 bg-white dark:bg-[#0F172A] border-slate-200 dark:border-slate-800 flex flex-col shadow-2xl transition-all duration-300">
                <div class="h-20 flex items-center px-6 border-b border-slate-100 dark:border-slate-800 bg-gradient-to-r from-slate-50 to-transparent dark:from-slate-900/50">
                    <div class="w-12 h-12 bg-gradient-to-br from-brandRed to-red-600 rounded-xl flex items-center justify-center text-white shadow-lg shadow-brandRed/30"><i class="fa-solid fa-layer-group text-xl"></i></div>
                    <div class="mx-4"><h1 class="font-black text-slate-800 dark:text-white leading-tight">AndroGov</h1><p class="text-[9px] text-brandRed font-bold uppercase tracking-widest">Enterprise</p></div>
                </div>
                <div class="p-4"><div class="flex items-center gap-3 p-3 rounded-2xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-sm">
                    <img src="https://ui-avatars.com/api/?name=Ayman&background=DC2626&color=fff&bold=true" class="w-10 h-10 rounded-full border-2 border-white shadow-sm">
                    <div class="overflow-hidden"><p class="text-xs font-bold truncate text-slate-800 dark:text-white">${_state.currentUser?.name || 'Ø³Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø¶Ùˆ'}</p><p class="text-[9px] text-brandRed font-bold uppercase truncate">${_roleLabels[_state.activeRole][lang]}</p></div>
                </div></div>
                <nav class="flex-1 overflow-y-auto p-5 custom-scroll space-y-1">`;

            menu.forEach(sec => {
                html += `<div class="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest px-3 mt-8 mb-3">${t(sec.section)}</div>`;
                sec.items.forEach(item => {
                    const isActive = currentPath === item.link;
                    html += `
                    <a href="${item.link}" class="flex items-center gap-4 px-4 py-3 rounded-2xl text-[13px] font-bold transition-all group ${isActive ? 'bg-gradient-to-r from-brandRed to-red-600 text-white shadow-glow' : 'text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800'}">
                        <i class="fa-solid ${item.icon} w-5 text-center transition-transform group-hover:scale-110"></i>
                        <span class="flex-1 truncate">${t(item.key)}</span>
                        ${isActive ? '<div class="active-dot"></div>' : ''}
                        ${item.badge ? `<span class="bg-blue-500 text-white text-[8px] px-1.5 py-0.5 rounded font-black uppercase animate-pulse">${item.badge}</span>` : ''}
                    </a>`;
                });
            });
            html += `</nav><div class="p-6 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50"><p class="text-[9px] text-center text-slate-400 font-medium tracking-tighter uppercase">Â© 2026 Andromeda IT Solutions</p></div></aside>`;
            container.innerHTML = html;
        }

        function renderHeader() {
            const container = document.getElementById('header-container');
            if (!container) return;
            const lang = getCurrentLang();
            const isRTL = lang === 'ar';
            const isDark = document.documentElement.classList.contains('dark');

            container.innerHTML = `
            <header class="h-20 glass-effect sticky top-0 z-40 bg-white/80 dark:bg-[#0F172A]/80 border-b border-slate-200 dark:border-slate-800 px-8 flex items-center justify-between">
                <div class="flex items-center gap-5">
                    <button onclick="AndroBot.toggle()" class="w-11 h-11 rounded-2xl border-2 border-slate-200 dark:border-slate-700 text-brandBlue flex items-center justify-center shadow-sm hover:bg-blue-50 transition-all group"><i class="fa-solid fa-robot text-xl"></i></button>
                    <div class="h-8 w-px bg-slate-200 dark:bg-slate-700 hidden sm:block"></div>
                    <div class="px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-xs font-bold text-brandRed hidden sm:block">
                         <i class="fa-solid fa-building-columns mr-2"></i> ${_roleLabels[_state.activeRole][lang]}
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <div class="relative group">
                        <button class="relative w-11 h-11 rounded-2xl border-2 border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 flex items-center justify-center transition-all hover:bg-orange-50">
                            <i class="fa-solid fa-bell"></i>
                            ${_state.unreadCount > 0 ? `<span class="absolute -top-1 -right-1 w-5 h-5 bg-brandRed text-white text-[10px] font-bold rounded-full flex items-center justify-center animate-pulse border-2 border-white dark:border-slate-800">${_state.unreadCount}</span>` : ''}
                        </button>
                        <div class="absolute top-full ${isRTL ? 'left-0' : 'right-0'} mt-3 w-80 bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-[2rem] shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50 overflow-hidden glass-effect text-right">
                            <div class="p-5 border-b border-slate-100 dark:border-slate-700 bg-gradient-to-r from-orange-500 to-amber-500 flex justify-between items-center text-white">
                                <span class="text-xs font-black uppercase tracking-widest">${t('notifications')}</span>
                                <button onclick="Layout.markAllRead()" class="text-[10px] underline font-bold">${t('markAllRead')}</button>
                            </div>
                            <div class="max-h-80 overflow-y-auto custom-scroll">
                                ${_state.notifications.map(n => `
                                    <div class="flex gap-4 p-5 border-b border-slate-50 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors ${!n.read ? 'bg-orange-50/20' : ''}">
                                        <div class="w-10 h-10 rounded-xl bg-${n.color}-100 dark:bg-${n.color}-900/30 text-${n.color}-600 dark:text-${n.color}-400 flex items-center justify-center shrink-0 border border-${n.color}-100 dark:border-${n.color}-900/50"><i class="fa-solid ${n.icon}"></i></div>
                                        <div class="flex-1 min-w-0">
                                            <p class="text-[11px] font-black text-slate-800 dark:text-white truncate tracking-tight">${n.title[lang]}</p>
                                            <p class="text-[10px] text-slate-500 dark:text-slate-400 mt-1 leading-snug">${n.body[lang]}</p>
                                            <div class="flex justify-between items-center mt-2"><span class="text-[9px] text-slate-400 font-bold">${getTimeAgo(n.time)}</span></div>
                                        </div>
                                    </div>`).join('')}
                            </div>
                        </div>
                    </div>
                    <button onclick="Layout.toggleLanguage()" class="w-11 h-11 rounded-2xl border-2 border-slate-200 dark:border-slate-700 text-xs font-black bg-white dark:bg-slate-800">${lang === 'ar' ? 'EN' : 'Ø¹'}</button>
                    <button onclick="Layout.toggleTheme()" class="w-11 h-11 rounded-2xl border-2 border-slate-200 dark:border-slate-700 flex items-center justify-center text-slate-600 dark:text-yellow-400 bg-white dark:bg-slate-800"><i class="fa-solid ${isDark ? 'fa-sun' : 'fa-moon'} text-lg"></i></button>
                    <button onclick="Layout.logout()" class="flex items-center gap-3 px-5 py-2.5 rounded-2xl bg-red-50 dark:bg-red-900/20 text-red-500 font-black text-xs hover:bg-red-500 hover:text-white transition-all shadow-sm"><i class="fa-solid fa-power-off text-sm"></i><span class="hidden md:inline uppercase tracking-widest">${t('logout')}</span></button>
                </div>
            </header>`;
        }

        return {
            init: function() {
                applyTheme();
                this.syncLayout();
                loadNotifications();
                const loader = document.getElementById('loadingOverlay');
                if (loader) setTimeout(() => { loader.classList.add('opacity-0', 'pointer-events-none'); setTimeout(() => loader.remove(), 500); }, 500);
                _state.isInitialized = true;
                console.log("ğŸ’ AndroGov Full Logic v10.5 Active [No Truncation Mode]");
            },
            syncLayout: function() {
                const lang = getCurrentLang();
                document.documentElement.lang = lang;
                document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
                const wrapper = document.querySelector('.main-content-wrapper');
                if (wrapper) {
                    if (lang === 'ar') { wrapper.classList.remove('md:ml-72'); wrapper.classList.add('md:mr-72'); }
                    else { wrapper.classList.remove('md:mr-72'); wrapper.classList.add('md:ml-72'); }
                }
                renderSidebar(); renderHeader();
                window.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang } }));
            },
            toggleLanguage: function() { localStorage.setItem('lang', getCurrentLang() === 'ar' ? 'en' : 'ar'); this.syncLayout(); },
            toggleTheme,
            markAllRead: () => { _state.unreadCount = 0; _state.notifications.forEach(n => n.read = true); renderHeader(); },
            logout: () => { if(confirm('ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ø¢Ù…Ù†ØŸ')) { localStorage.clear(); window.location.href = '../index.html'; } }
        };
    })();

    // â•â• BOOTSTRAP â•â•
    document.addEventListener('DOMContentLoaded', () => {
        const user = JSON.parse(localStorage.getItem('currentUser')) || { name: 'Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ù…ÙˆÙ‚Ø±', role: 'Ø¹Ø¶Ùˆ Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©' };
        document.getElementById('dynamicName').innerText = user.name;
        document.getElementById('dynamicTitle').innerText = user.role;
        if (user.role.includes('Ø¹Ø¶Ùˆ')) document.getElementById('secretaryActions').classList.remove('hidden');
        Layout.init();
    });
    </script>
</body>
</html>
